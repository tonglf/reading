## 第 3 章  库函数问题

### 3.1 sprintf函数引起的缓冲区溢出

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.2 snprintf函数format参数的问题

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.3 错误使用snprintf函数返回值

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.4 字符串复制不完整

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.5 string类的c_str方法使用不当

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.6 string类的“”操作符使用不正确

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.7 不正确的字符串比较

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.8 strncpy函数没有复制结束符

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.9 调用memcpy函数前未初始化缓冲区

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.10 误用sizeof操作符取字符串长度

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.11 string类find函数返回值判定

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.12 stringstream的清空

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.13 调用strptime函数前需初始化tm

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.14 使用feof函数的陷阱

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.15 for循环中调用vector容器insert函数

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.16 multiset容器erase函数的误用

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.17 慎用容器类erase函数的返回值

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.18 for循环中调用vector容器erase函数

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.19 getopt函数参数问题

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.20 不用errno判断系统调用是否成功

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.21 strcat函数造成的段错误

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.22 危险的strdup函数

**代码示例**

```cpp

```

**现象&后果**



**Bug分析**



**正确代码**

```cpp

```



### 3.23 小结